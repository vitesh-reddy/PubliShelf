<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Login - PubliShelf</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
	<link rel="stylesheet" href="/css/styles.css">
</head>

<body class="bg-gray-50">
	<div
		class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-purple-50 to-white">
		<div class="max-w-md w-full">
			<!-- Logo -->
			<div class="text-center mb-10">
				<a href="/" class="inline-block">
					<span
						class="text-4xl font-bold bg-gradient-to-r from-purple-600 to-indigo-600 text-transparent bg-clip-text">PubliShelf</span>
				</a>
				<h2 class="mt-6 text-3xl font-extrabold text-gray-900">Welcome back!</h2>
				<p class="mt-2 text-sm text-gray-600">
					Don't have an account?
					<button id="showSignupOptions" class="font-medium text-purple-600 hover:text-purple-500">Sign
						up</button>
				</p>
			</div>

			<!-- Login Form -->
			<form>
				<div class="bg-white p-8 rounded-xl shadow-lg space-y-6 animate-fade-in">
					<div class="space-y-4">
						<div>
							<label for="email" class="block text-sm font-medium text-gray-700">Email address</label>
							<div class="mt-1 relative">
								<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
									<i class="fas fa-envelope text-gray-400"></i>
								</div>
								<input id="email" name="email" type="email" required class="appearance-none block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg 
                                focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent
                                placeholder-gray-400 transition-all duration-300" placeholder="user@gmail.com">
							</div>
						</div>

						<div>
							<label for="password" class="block text-sm font-medium text-gray-700">Password</label>
							<div class="mt-1 relative">
								<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
									<i class="fas fa-lock text-gray-400"></i>
								</div>
								<input id="password" name="password" type="password" required class="appearance-none block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg 
                                focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent
                                placeholder-gray-400 transition-all duration-300" placeholder="••••••••">
								<button type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center">
									<i class="fas fa-eye text-gray-400 hover:text-gray-600 cursor-pointer"></i>
								</button>
							</div>
						</div>
						<!--  -->
						<p id="PasswordIncorrectClass" style="color: red;"></p>
					</div>

					<div class="flex items-center justify-between">
						<div class="flex items-center">
							<input id="remember-me" name="remember-me" type="checkbox"
								class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded cursor-pointer">
							<label for="remember-me" class="ml-2 block text-sm text-gray-700 cursor-pointer">Remember
								me</label>
						</div>
						<a href="#" class="text-sm font-medium text-purple-600 hover:text-purple-500">Forgot
							password?</a>
					</div>

					<!--  -->
					<button onclick="() => alert(`Hii`)" type="submit" id="SignInButtonInAuthLogin"
						class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-all duration-300 transform hover:-translate-y-0.5">
						Sign in
					</button>
				</div>
			</form>

			<!-- Signup Options Modal -->
			<div id="signupModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
				<div class="bg-white p-8 rounded-xl shadow-xl max-w-md w-full mx-4 transform transition-all duration-300">
					<div class="flex justify-between items-center mb-6">
						<h3 class="text-2xl font-bold text-gray-900">Choose Account Type</h3>
						<button id="closeModal" class="text-gray-400 hover:text-gray-600">
							<i class="fas fa-times text-xl"></i>
						</button>
					</div>
					<div class="space-y-4">
						<a href="/buyer/signup"
							class="block w-full p-4 border border-gray-200 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-all duration-300">
							<div class="flex items-center">
								<i class="fas fa-user-tag text-2xl text-purple-600 mr-4"></i>
								<div>
									<h4 class="text-lg font-semibold text-gray-900">Buyer</h4>
									<p class="text-sm text-gray-600">Browse and purchase books</p>
								</div>
							</div>
						</a>
						<a href="/publisher/signup"
							class="block w-full p-4 border border-gray-200 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-all duration-300">
							<div class="flex items-center">
								<i class="fas fa-book-open text-2xl text-purple-600 mr-4"></i>
								<div>
									<h4 class="text-lg font-semibold text-gray-900">Publisher</h4>
									<p class="text-sm text-gray-600">List and sell your books</p>
								</div>
							</div>
						</a>
						<!-- <a href="/admin/signup"
							class="block w-full p-4 border border-gray-200 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-all duration-300">
							<div class="flex items-center">
								<i class="fas fa-user-shield text-2xl text-purple-600 mr-4"></i>
								<div>
									<h4 class="text-lg font-semibold text-gray-900">Admin</h4>
									<p class="text-sm text-gray-600">Manage the platform</p>
								</div>
							</div>
						</a> -->
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>
		const signupbutton = document.getElementById('SignInButtonInAuthLogin');
		const displayContent = document.getElementById('PasswordIncorrectClass');

		signupbutton.addEventListener('click', async (event) => {
			const myemail = document.getElementById('email').value;
			const mypassword = document.getElementById('password').value;
			console.log('Hii');
			event.preventDefault();

			try {
				const res = await fetch('/auth/login', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify({ email: myemail, password: mypassword }),
				});	
				const data = await res.json();			
				if (res.status == 401 || res.status == 403) 
					displayContent.innerHTML = data.message;
				else if (res.status == 200)
					window.location.href = `/${data.user.role}/dashboard`;
				else  
					console.log("paalu thaagi bajjo");
			}
			catch (error) {
				console.log("Hii", error);
			}

		});




		document.addEventListener('DOMContentLoaded', () => {
			const showSignupOptions = document.getElementById('showSignupOptions');
			const signupModal = document.getElementById('signupModal');
			const closeModal = document.getElementById('closeModal');
			const passwordInput = document.getElementById('password');
			const togglePassword = document.querySelector('.fa-eye');

			showSignupOptions.addEventListener('click', () => {
				signupModal.classList.remove('hidden');
				document.body.style.overflow = 'hidden';
			});

			closeModal.addEventListener('click', () => {
				signupModal.classList.add('hidden');
				document.body.style.overflow = 'auto';
			});

			signupModal.addEventListener('click', (e) => {
				if (e.target === signupModal) {
					signupModal.classList.add('hidden');
					document.body.style.overflow = 'auto';
				}
			});

			togglePassword.addEventListener('click', () => {
				const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
				passwordInput.setAttribute('type', type);
				togglePassword.classList.toggle('fa-eye');
				togglePassword.classList.toggle('fa-eye-slash');
			});
		});
	</script>
</body>

</html>